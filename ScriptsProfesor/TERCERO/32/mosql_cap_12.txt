SQL> set linesize 130
SQL> set pagesize 99
SQL> set colsep '|=|'
SQL> set null s/Dato
SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,228]
SQL> SELECT R.NAME REGION,
  2   TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  GROUP BY R.NAME, O.MONTH;

REGION              |=|MONTH                               |=|SUM(O.TOT_SALES)                                                    
--------------------|=|------------------------------------|=|----------------                                                    
Mid-Atlantic        |=|May                                 |=|          592935                                                    
Mid-Atlantic        |=|August                              |=|          460520                                                    
Mid-Atlantic        |=|September                           |=|          392898                                                    
Southeast US        |=|October                             |=|          536841                                                    
Southeast US        |=|February                            |=|          618423                                                    
Southeast US        |=|March                               |=|          655993                                                    
Southwest US        |=|August                              |=|          447799                                                    
Southwest US        |=|September                           |=|          666520                                                    
Northwest US        |=|August                              |=|          525770                                                    
Central US          |=|August                              |=|          620780                                                    
New England         |=|August                              |=|          547656                                                    
New England         |=|November                            |=|          461395                                                    
New England         |=|December                            |=|          533314                                                    
Mid-Atlantic        |=|October                             |=|          510117                                                    
Southeast US        |=|November                            |=|          553866                                                    
Southeast US        |=|December                            |=|          613700                                                    
Southeast US        |=|June                                |=|          568572                                                    
Southwest US        |=|January                             |=|          637628                                                    
Southwest US        |=|February                            |=|          571706                                                    
Southwest US        |=|April                               |=|          597942                                                    
Northwest US        |=|October                             |=|          598705                                                    
Northwest US        |=|December                            |=|          529781                                                    
Central US          |=|April                               |=|          458383                                                    
Central US          |=|July                                |=|          479537                                                    
Central US          |=|February                            |=|          481184                                                    
New England         |=|July                                |=|          559334                                                    
Southwest US        |=|July                                |=|          420337                                                    
Northwest US        |=|July                                |=|          610418                                                    
Central US          |=|November                            |=|          557309                                                    
New England         |=|May                                 |=|          566285                                                    
Mid-Atlantic        |=|April                               |=|          541146                                                    
Mid-Atlantic        |=|November                            |=|          532889                                                    
Southeast US        |=|August                              |=|          478765                                                    
Northwest US        |=|April                               |=|          631372                                                    
Central US          |=|January                             |=|          450162                                                    
New England         |=|June                                |=|          503354                                                    
New England         |=|September                           |=|          575589                                                    
Southeast US        |=|April                               |=|          610017                                                    
Southwest US        |=|June                                |=|          615202                                                    
New England         |=|January                             |=|          509215                                                    
New England         |=|March                               |=|          566483                                                    
New England         |=|October                             |=|          549648                                                    
Mid-Atlantic        |=|July                                |=|          606914                                                    
Mid-Atlantic        |=|February                            |=|          428676                                                    
Southeast US        |=|January                             |=|          379021                                                    
Southeast US        |=|May                                 |=|          661094                                                    
Southeast US        |=|July                                |=|          556992                                                    
Southwest US        |=|December                            |=|          633101                                                    
Southwest US        |=|October                             |=|          556906                                                    
Northwest US        |=|November                            |=|          467235                                                    
Northwest US        |=|May                                 |=|          752284                                                    
Northwest US        |=|June                                |=|          449683                                                    
Central US          |=|May                                 |=|          565160                                                    
Mid-Atlantic        |=|December                            |=|          492458                                                    
Mid-Atlantic        |=|January                             |=|          610697                                                    
Southeast US        |=|September                           |=|          635211                                                    
Southwest US        |=|May                                 |=|          611506                                                    
Northwest US        |=|February                            |=|          573601                                                    
Northwest US        |=|March                               |=|          577172                                                    
Central US          |=|June                                |=|          566434                                                    
Central US          |=|September                           |=|          536323                                                    
New England         |=|February                            |=|          615746                                                    
New England         |=|April                               |=|          597622                                                    
Mid-Atlantic        |=|June                                |=|          501485                                                    
Mid-Atlantic        |=|March                               |=|          637031                                                    
Southwest US        |=|November                            |=|          595164                                                    
Southwest US        |=|March                               |=|          500920                                                    
Northwest US        |=|January                             |=|          441602                                                    
Northwest US        |=|September                           |=|          581751                                                    
Central US          |=|October                             |=|          527420                                                    
Central US          |=|December                            |=|          522784                                                    
Central US          |=|March                               |=|          473425                                                    

72 rows selected.

SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,230]
SQL> 
SQL> SELECT R.NAME REGION,
  2   TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  GROUP BY R.NAME, O.MONTH
  6  UNION ALL
  7  SELECT R.NAME REGION, NULL, SUM(O.TOT_SALES)
  8  FROM ORDERS O, REGION R
  9  WHERE R.REGION_ID = O.REGION_ID
 10  GROUP BY R.NAME
 11  UNION ALL
 12  SELECT NULL, NULL, SUM(O.TOT_SALES)
 13  FROM ORDERS O, REGION R
 14  WHERE R.REGION_ID = O.REGION_ID;

REGION              |=|MONTH                               |=|SUM(O.TOT_SALES)                                                    
--------------------|=|------------------------------------|=|----------------                                                    
Mid-Atlantic        |=|May                                 |=|          592935                                                    
Mid-Atlantic        |=|August                              |=|          460520                                                    
Mid-Atlantic        |=|September                           |=|          392898                                                    
Southeast US        |=|October                             |=|          536841                                                    
Southeast US        |=|February                            |=|          618423                                                    
Southeast US        |=|March                               |=|          655993                                                    
Southwest US        |=|August                              |=|          447799                                                    
Southwest US        |=|September                           |=|          666520                                                    
Northwest US        |=|August                              |=|          525770                                                    
Central US          |=|August                              |=|          620780                                                    
New England         |=|August                              |=|          547656                                                    
New England         |=|November                            |=|          461395                                                    
New England         |=|December                            |=|          533314                                                    
Mid-Atlantic        |=|October                             |=|          510117                                                    
Southeast US        |=|November                            |=|          553866                                                    
Southeast US        |=|December                            |=|          613700                                                    
Southeast US        |=|June                                |=|          568572                                                    
Southwest US        |=|January                             |=|          637628                                                    
Southwest US        |=|February                            |=|          571706                                                    
Southwest US        |=|April                               |=|          597942                                                    
Northwest US        |=|October                             |=|          598705                                                    
Northwest US        |=|December                            |=|          529781                                                    
Central US          |=|April                               |=|          458383                                                    
Central US          |=|July                                |=|          479537                                                    
Central US          |=|February                            |=|          481184                                                    
New England         |=|July                                |=|          559334                                                    
Southwest US        |=|July                                |=|          420337                                                    
Northwest US        |=|July                                |=|          610418                                                    
Central US          |=|November                            |=|          557309                                                    
New England         |=|May                                 |=|          566285                                                    
Mid-Atlantic        |=|April                               |=|          541146                                                    
Mid-Atlantic        |=|November                            |=|          532889                                                    
Southeast US        |=|August                              |=|          478765                                                    
Northwest US        |=|April                               |=|          631372                                                    
Central US          |=|January                             |=|          450162                                                    
New England         |=|June                                |=|          503354                                                    
New England         |=|September                           |=|          575589                                                    
Southeast US        |=|April                               |=|          610017                                                    
Southwest US        |=|June                                |=|          615202                                                    
New England         |=|January                             |=|          509215                                                    
New England         |=|March                               |=|          566483                                                    
New England         |=|October                             |=|          549648                                                    
Mid-Atlantic        |=|July                                |=|          606914                                                    
Mid-Atlantic        |=|February                            |=|          428676                                                    
Southeast US        |=|January                             |=|          379021                                                    
Southeast US        |=|May                                 |=|          661094                                                    
Southeast US        |=|July                                |=|          556992                                                    
Southwest US        |=|December                            |=|          633101                                                    
Southwest US        |=|October                             |=|          556906                                                    
Northwest US        |=|November                            |=|          467235                                                    
Northwest US        |=|May                                 |=|          752284                                                    
Northwest US        |=|June                                |=|          449683                                                    
Central US          |=|May                                 |=|          565160                                                    
Mid-Atlantic        |=|December                            |=|          492458                                                    
Mid-Atlantic        |=|January                             |=|          610697                                                    
Southeast US        |=|September                           |=|          635211                                                    
Southwest US        |=|May                                 |=|          611506                                                    
Northwest US        |=|February                            |=|          573601                                                    
Northwest US        |=|March                               |=|          577172                                                    
Central US          |=|June                                |=|          566434                                                    
Central US          |=|September                           |=|          536323                                                    
New England         |=|February                            |=|          615746                                                    
New England         |=|April                               |=|          597622                                                    
Mid-Atlantic        |=|June                                |=|          501485                                                    
Mid-Atlantic        |=|March                               |=|          637031                                                    
Southwest US        |=|November                            |=|          595164                                                    
Southwest US        |=|March                               |=|          500920                                                    
Northwest US        |=|January                             |=|          441602                                                    
Northwest US        |=|September                           |=|          581751                                                    
Central US          |=|October                             |=|          527420                                                    
Central US          |=|December                            |=|          522784                                                    
Central US          |=|March                               |=|          473425                                                    
New England         |=|s/Dato                              |=|         6585641                                                    
Mid-Atlantic        |=|s/Dato                              |=|         6307766                                                    
Northwest US        |=|s/Dato                              |=|         6739374                                                    
Southeast US        |=|s/Dato                              |=|         6868495                                                    
Central US          |=|s/Dato                              |=|         6238901                                                    
Southwest US        |=|s/Dato                              |=|         6854731                                                    
s/Dato              |=|s/Dato                              |=|        39594908                                                    

79 rows selected.

SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,232]
SQL> 
SQL> SELECT R.NAME REGION,
  2   TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  GROUP BY ROLLUP (R.NAME, O.MONTH);

REGION              |=|MONTH                               |=|SUM(O.TOT_SALES)                                                    
--------------------|=|------------------------------------|=|----------------                                                    
Central US          |=|January                             |=|          450162                                                    
Central US          |=|February                            |=|          481184                                                    
Central US          |=|March                               |=|          473425                                                    
Central US          |=|April                               |=|          458383                                                    
Central US          |=|May                                 |=|          565160                                                    
Central US          |=|June                                |=|          566434                                                    
Central US          |=|July                                |=|          479537                                                    
Central US          |=|August                              |=|          620780                                                    
Central US          |=|September                           |=|          536323                                                    
Central US          |=|October                             |=|          527420                                                    
Central US          |=|November                            |=|          557309                                                    
Central US          |=|December                            |=|          522784                                                    
Central US          |=|s/Dato                              |=|         6238901                                                    
New England         |=|January                             |=|          509215                                                    
New England         |=|February                            |=|          615746                                                    
New England         |=|March                               |=|          566483                                                    
New England         |=|April                               |=|          597622                                                    
New England         |=|May                                 |=|          566285                                                    
New England         |=|June                                |=|          503354                                                    
New England         |=|July                                |=|          559334                                                    
New England         |=|August                              |=|          547656                                                    
New England         |=|September                           |=|          575589                                                    
New England         |=|October                             |=|          549648                                                    
New England         |=|November                            |=|          461395                                                    
New England         |=|December                            |=|          533314                                                    
New England         |=|s/Dato                              |=|         6585641                                                    
Mid-Atlantic        |=|January                             |=|          610697                                                    
Mid-Atlantic        |=|February                            |=|          428676                                                    
Mid-Atlantic        |=|March                               |=|          637031                                                    
Mid-Atlantic        |=|April                               |=|          541146                                                    
Mid-Atlantic        |=|May                                 |=|          592935                                                    
Mid-Atlantic        |=|June                                |=|          501485                                                    
Mid-Atlantic        |=|July                                |=|          606914                                                    
Mid-Atlantic        |=|August                              |=|          460520                                                    
Mid-Atlantic        |=|September                           |=|          392898                                                    
Mid-Atlantic        |=|October                             |=|          510117                                                    
Mid-Atlantic        |=|November                            |=|          532889                                                    
Mid-Atlantic        |=|December                            |=|          492458                                                    
Mid-Atlantic        |=|s/Dato                              |=|         6307766                                                    
Northwest US        |=|January                             |=|          441602                                                    
Northwest US        |=|February                            |=|          573601                                                    
Northwest US        |=|March                               |=|          577172                                                    
Northwest US        |=|April                               |=|          631372                                                    
Northwest US        |=|May                                 |=|          752284                                                    
Northwest US        |=|June                                |=|          449683                                                    
Northwest US        |=|July                                |=|          610418                                                    
Northwest US        |=|August                              |=|          525770                                                    
Northwest US        |=|September                           |=|          581751                                                    
Northwest US        |=|October                             |=|          598705                                                    
Northwest US        |=|November                            |=|          467235                                                    
Northwest US        |=|December                            |=|          529781                                                    
Northwest US        |=|s/Dato                              |=|         6739374                                                    
Southeast US        |=|January                             |=|          379021                                                    
Southeast US        |=|February                            |=|          618423                                                    
Southeast US        |=|March                               |=|          655993                                                    
Southeast US        |=|April                               |=|          610017                                                    
Southeast US        |=|May                                 |=|          661094                                                    
Southeast US        |=|June                                |=|          568572                                                    
Southeast US        |=|July                                |=|          556992                                                    
Southeast US        |=|August                              |=|          478765                                                    
Southeast US        |=|September                           |=|          635211                                                    
Southeast US        |=|October                             |=|          536841                                                    
Southeast US        |=|November                            |=|          553866                                                    
Southeast US        |=|December                            |=|          613700                                                    
Southeast US        |=|s/Dato                              |=|         6868495                                                    
Southwest US        |=|January                             |=|          637628                                                    
Southwest US        |=|February                            |=|          571706                                                    
Southwest US        |=|March                               |=|          500920                                                    
Southwest US        |=|April                               |=|          597942                                                    
Southwest US        |=|May                                 |=|          611506                                                    
Southwest US        |=|June                                |=|          615202                                                    
Southwest US        |=|July                                |=|          420337                                                    
Southwest US        |=|August                              |=|          447799                                                    
Southwest US        |=|September                           |=|          666520                                                    
Southwest US        |=|October                             |=|          556906                                                    
Southwest US        |=|November                            |=|          595164                                                    
Southwest US        |=|December                            |=|          633101                                                    
Southwest US        |=|s/Dato                              |=|         6854731                                                    
s/Dato              |=|s/Dato                              |=|        39594908                                                    

79 rows selected.

SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,234]
SQL> rem If you want to generate subtotals for each month
SQL> rem instead of for each region, all you
SQL> rem need to do is change the order of columns in the ROLLUP operation,
SQL> rem
SQL> SELECT R.NAME REGION,
  2  TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  GROUP BY ROLLUP (O.MONTH, R.NAME);

REGION              |=|MONTH                               |=|SUM(O.TOT_SALES)                                                    
--------------------|=|------------------------------------|=|----------------                                                    
Central US          |=|January                             |=|          450162                                                    
New England         |=|January                             |=|          509215                                                    
Mid-Atlantic        |=|January                             |=|          610697                                                    
Northwest US        |=|January                             |=|          441602                                                    
Southeast US        |=|January                             |=|          379021                                                    
Southwest US        |=|January                             |=|          637628                                                    
s/Dato              |=|January                             |=|         3028325                                                    
Central US          |=|February                            |=|          481184                                                    
New England         |=|February                            |=|          615746                                                    
Mid-Atlantic        |=|February                            |=|          428676                                                    
Northwest US        |=|February                            |=|          573601                                                    
Southeast US        |=|February                            |=|          618423                                                    
Southwest US        |=|February                            |=|          571706                                                    
s/Dato              |=|February                            |=|         3289336                                                    
Central US          |=|March                               |=|          473425                                                    
New England         |=|March                               |=|          566483                                                    
Mid-Atlantic        |=|March                               |=|          637031                                                    
Northwest US        |=|March                               |=|          577172                                                    
Southeast US        |=|March                               |=|          655993                                                    
Southwest US        |=|March                               |=|          500920                                                    
s/Dato              |=|March                               |=|         3411024                                                    
Central US          |=|April                               |=|          458383                                                    
New England         |=|April                               |=|          597622                                                    
Mid-Atlantic        |=|April                               |=|          541146                                                    
Northwest US        |=|April                               |=|          631372                                                    
Southeast US        |=|April                               |=|          610017                                                    
Southwest US        |=|April                               |=|          597942                                                    
s/Dato              |=|April                               |=|         3436482                                                    
Central US          |=|May                                 |=|          565160                                                    
New England         |=|May                                 |=|          566285                                                    
Mid-Atlantic        |=|May                                 |=|          592935                                                    
Northwest US        |=|May                                 |=|          752284                                                    
Southeast US        |=|May                                 |=|          661094                                                    
Southwest US        |=|May                                 |=|          611506                                                    
s/Dato              |=|May                                 |=|         3749264                                                    
Central US          |=|June                                |=|          566434                                                    
New England         |=|June                                |=|          503354                                                    
Mid-Atlantic        |=|June                                |=|          501485                                                    
Northwest US        |=|June                                |=|          449683                                                    
Southeast US        |=|June                                |=|          568572                                                    
Southwest US        |=|June                                |=|          615202                                                    
s/Dato              |=|June                                |=|         3204730                                                    
Central US          |=|July                                |=|          479537                                                    
New England         |=|July                                |=|          559334                                                    
Mid-Atlantic        |=|July                                |=|          606914                                                    
Northwest US        |=|July                                |=|          610418                                                    
Southeast US        |=|July                                |=|          556992                                                    
Southwest US        |=|July                                |=|          420337                                                    
s/Dato              |=|July                                |=|         3233532                                                    
Central US          |=|August                              |=|          620780                                                    
New England         |=|August                              |=|          547656                                                    
Mid-Atlantic        |=|August                              |=|          460520                                                    
Northwest US        |=|August                              |=|          525770                                                    
Southeast US        |=|August                              |=|          478765                                                    
Southwest US        |=|August                              |=|          447799                                                    
s/Dato              |=|August                              |=|         3081290                                                    
Central US          |=|September                           |=|          536323                                                    
New England         |=|September                           |=|          575589                                                    
Mid-Atlantic        |=|September                           |=|          392898                                                    
Northwest US        |=|September                           |=|          581751                                                    
Southeast US        |=|September                           |=|          635211                                                    
Southwest US        |=|September                           |=|          666520                                                    
s/Dato              |=|September                           |=|         3388292                                                    
Central US          |=|October                             |=|          527420                                                    
New England         |=|October                             |=|          549648                                                    
Mid-Atlantic        |=|October                             |=|          510117                                                    
Northwest US        |=|October                             |=|          598705                                                    
Southeast US        |=|October                             |=|          536841                                                    
Southwest US        |=|October                             |=|          556906                                                    
s/Dato              |=|October                             |=|         3279637                                                    
Central US          |=|November                            |=|          557309                                                    
New England         |=|November                            |=|          461395                                                    
Mid-Atlantic        |=|November                            |=|          532889                                                    
Northwest US        |=|November                            |=|          467235                                                    
Southeast US        |=|November                            |=|          553866                                                    
Southwest US        |=|November                            |=|          595164                                                    
s/Dato              |=|November                            |=|         3167858                                                    
Central US          |=|December                            |=|          522784                                                    
New England         |=|December                            |=|          533314                                                    
Mid-Atlantic        |=|December                            |=|          492458                                                    
Northwest US        |=|December                            |=|          529781                                                    
Southeast US        |=|December                            |=|          613700                                                    
Southwest US        |=|December                            |=|          633101                                                    
s/Dato              |=|December                            |=|         3325138                                                    
s/Dato              |=|s/Dato                              |=|        39594908                                                    

85 rows selected.

SQL> --- ----------------------------------
SQL> 
SQL> rem [Mishra & Beaulieu,2002,235]
SQL> rem Adding dimensions does not result in additional complexity.
SQL> rem The following query
SQL> rem rolls up subtotals for the region, the month, and the year for the first quarter
SQL> 
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY ROLLUP (O.YEAR, O.MONTH, R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|SUM(O.TOT_SALES)                                       
----------|=|------------------------------------|=|--------------------|=|----------------                                       
      2001|=|January                             |=|Central US          |=|          450162                                       
      2001|=|January                             |=|New England         |=|          509215                                       
      2001|=|January                             |=|Mid-Atlantic        |=|          610697                                       
      2001|=|January                             |=|Northwest US        |=|          441602                                       
      2001|=|January                             |=|Southeast US        |=|          379021                                       
      2001|=|January                             |=|Southwest US        |=|          637628                                       
      2001|=|January                             |=|s/Dato              |=|         3028325                                       
      2001|=|February                            |=|Central US          |=|          481184                                       
      2001|=|February                            |=|New England         |=|          615746                                       
      2001|=|February                            |=|Mid-Atlantic        |=|          428676                                       
      2001|=|February                            |=|Northwest US        |=|          573601                                       
      2001|=|February                            |=|Southeast US        |=|          618423                                       
      2001|=|February                            |=|Southwest US        |=|          571706                                       
      2001|=|February                            |=|s/Dato              |=|         3289336                                       
      2001|=|March                               |=|Central US          |=|          473425                                       
      2001|=|March                               |=|New England         |=|          566483                                       
      2001|=|March                               |=|Mid-Atlantic        |=|          637031                                       
      2001|=|March                               |=|Northwest US        |=|          577172                                       
      2001|=|March                               |=|Southeast US        |=|          655993                                       
      2001|=|March                               |=|Southwest US        |=|          500920                                       
      2001|=|March                               |=|s/Dato              |=|         3411024                                       
      2001|=|s/Dato                              |=|s/Dato              |=|         9728685                                       
s/Dato    |=|s/Dato                              |=|s/Dato              |=|         9728685                                       

23 rows selected.

SQL> 
SQL> 
SQL> 
SQL> 
SQL> 
SQL> 
SQL> rem   [Mishra & Beaulieu,2002,236]
SQL> rem As an example of a partial ROLLUP, let's see what happens
SQL> rem  when you take out the
SQL> rem first column, which is O.YEAR, from the previous
SQL> rem ROLLUP operation and move it
SQL> rem into the GROUP BY clause
SQL> 
SQL> 
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY O.YEAR ROLLUP (O.MONTH, R.NAME);
GROUP BY O.YEAR ROLLUP (O.MONTH, R.NAME)
                *
ERROR at line 6:
ORA-00933: SQL command not properly ended 


SQL> 
SQL> 
SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,237]
SQL> 
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY O.YEAR, O.MONTH ROLLUP (R.NAME);
GROUP BY O.YEAR, O.MONTH ROLLUP (R.NAME)
                         *
ERROR at line 6:
ORA-00933: SQL command not properly ended 


SQL> 
SQL> 
SQL> rem CUBE
SQL> rem The CUBE extension of the GROUP BY clause takes aggregation one step further
SQL> rem than ROLLUP.
SQL> 
SQL> rem [Mishra & Beaulieu,2002,238]
SQL> 
SQL> SELECT R.NAME REGION, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  GROUP BY CUBE(R.NAME, O.MONTH);

REGION              |=|MONTH                               |=|SUM(O.TOT_SALES)                                                    
--------------------|=|------------------------------------|=|----------------                                                    
s/Dato              |=|s/Dato                              |=|        39594908                                                    
s/Dato              |=|January                             |=|         3028325                                                    
s/Dato              |=|February                            |=|         3289336                                                    
s/Dato              |=|March                               |=|         3411024                                                    
s/Dato              |=|April                               |=|         3436482                                                    
s/Dato              |=|May                                 |=|         3749264                                                    
s/Dato              |=|June                                |=|         3204730                                                    
s/Dato              |=|July                                |=|         3233532                                                    
s/Dato              |=|August                              |=|         3081290                                                    
s/Dato              |=|September                           |=|         3388292                                                    
s/Dato              |=|October                             |=|         3279637                                                    
s/Dato              |=|November                            |=|         3167858                                                    
s/Dato              |=|December                            |=|         3325138                                                    
Central US          |=|s/Dato                              |=|         6238901                                                    
Central US          |=|January                             |=|          450162                                                    
Central US          |=|February                            |=|          481184                                                    
Central US          |=|March                               |=|          473425                                                    
Central US          |=|April                               |=|          458383                                                    
Central US          |=|May                                 |=|          565160                                                    
Central US          |=|June                                |=|          566434                                                    
Central US          |=|July                                |=|          479537                                                    
Central US          |=|August                              |=|          620780                                                    
Central US          |=|September                           |=|          536323                                                    
Central US          |=|October                             |=|          527420                                                    
Central US          |=|November                            |=|          557309                                                    
Central US          |=|December                            |=|          522784                                                    
New England         |=|s/Dato                              |=|         6585641                                                    
New England         |=|January                             |=|          509215                                                    
New England         |=|February                            |=|          615746                                                    
New England         |=|March                               |=|          566483                                                    
New England         |=|April                               |=|          597622                                                    
New England         |=|May                                 |=|          566285                                                    
New England         |=|June                                |=|          503354                                                    
New England         |=|July                                |=|          559334                                                    
New England         |=|August                              |=|          547656                                                    
New England         |=|September                           |=|          575589                                                    
New England         |=|October                             |=|          549648                                                    
New England         |=|November                            |=|          461395                                                    
New England         |=|December                            |=|          533314                                                    
Mid-Atlantic        |=|s/Dato                              |=|         6307766                                                    
Mid-Atlantic        |=|January                             |=|          610697                                                    
Mid-Atlantic        |=|February                            |=|          428676                                                    
Mid-Atlantic        |=|March                               |=|          637031                                                    
Mid-Atlantic        |=|April                               |=|          541146                                                    
Mid-Atlantic        |=|May                                 |=|          592935                                                    
Mid-Atlantic        |=|June                                |=|          501485                                                    
Mid-Atlantic        |=|July                                |=|          606914                                                    
Mid-Atlantic        |=|August                              |=|          460520                                                    
Mid-Atlantic        |=|September                           |=|          392898                                                    
Mid-Atlantic        |=|October                             |=|          510117                                                    
Mid-Atlantic        |=|November                            |=|          532889                                                    
Mid-Atlantic        |=|December                            |=|          492458                                                    
Northwest US        |=|s/Dato                              |=|         6739374                                                    
Northwest US        |=|January                             |=|          441602                                                    
Northwest US        |=|February                            |=|          573601                                                    
Northwest US        |=|March                               |=|          577172                                                    
Northwest US        |=|April                               |=|          631372                                                    
Northwest US        |=|May                                 |=|          752284                                                    
Northwest US        |=|June                                |=|          449683                                                    
Northwest US        |=|July                                |=|          610418                                                    
Northwest US        |=|August                              |=|          525770                                                    
Northwest US        |=|September                           |=|          581751                                                    
Northwest US        |=|October                             |=|          598705                                                    
Northwest US        |=|November                            |=|          467235                                                    
Northwest US        |=|December                            |=|          529781                                                    
Southeast US        |=|s/Dato                              |=|         6868495                                                    
Southeast US        |=|January                             |=|          379021                                                    
Southeast US        |=|February                            |=|          618423                                                    
Southeast US        |=|March                               |=|          655993                                                    
Southeast US        |=|April                               |=|          610017                                                    
Southeast US        |=|May                                 |=|          661094                                                    
Southeast US        |=|June                                |=|          568572                                                    
Southeast US        |=|July                                |=|          556992                                                    
Southeast US        |=|August                              |=|          478765                                                    
Southeast US        |=|September                           |=|          635211                                                    
Southeast US        |=|October                             |=|          536841                                                    
Southeast US        |=|November                            |=|          553866                                                    
Southeast US        |=|December                            |=|          613700                                                    
Southwest US        |=|s/Dato                              |=|         6854731                                                    
Southwest US        |=|January                             |=|          637628                                                    
Southwest US        |=|February                            |=|          571706                                                    
Southwest US        |=|March                               |=|          500920                                                    
Southwest US        |=|April                               |=|          597942                                                    
Southwest US        |=|May                                 |=|          611506                                                    
Southwest US        |=|June                                |=|          615202                                                    
Southwest US        |=|July                                |=|          420337                                                    
Southwest US        |=|August                              |=|          447799                                                    
Southwest US        |=|September                           |=|          666520                                                    
Southwest US        |=|October                             |=|          556906                                                    
Southwest US        |=|November                            |=|          595164                                                    
Southwest US        |=|December                            |=|          633101                                                    

91 rows selected.

SQL> 
SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,239 & 240]
SQL> /*
SQL> Note that the output contains not only the subtotals for each region, but also the
SQL> subtotals for each month. You can get the same result from a query without the
SQL> CUBE operation.
SQL> */
SQL> 
SQL> SELECT R.NAME REGION, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  GROUP BY R.NAME, O.MONTH
  6  UNION ALL
  7  SELECT R.NAME REGION, NULL, SUM(O.TOT_SALES)
  8  FROM ORDERS O, REGION R
  9  WHERE R.REGION_ID = O.REGION_ID
 10  GROUP BY R.NAME
 11  UNION ALL
 12  SELECT NULL, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH, SUM(O.TOT_SALES)
 13  FROM ORDERS O, REGION R
 14  WHERE R.REGION_ID = O.REGION_ID
 15  GROUP BY O.MONTH
 16  UNION ALL
 17  SELECT NULL, NULL, SUM(O.TOT_SALES)
 18  FROM ORDERS O, REGION R
 19  WHERE R.REGION_ID = O.REGION_ID;

REGION              |=|MONTH                               |=|SUM(O.TOT_SALES)                                                    
--------------------|=|------------------------------------|=|----------------                                                    
Mid-Atlantic        |=|May                                 |=|          592935                                                    
Mid-Atlantic        |=|August                              |=|          460520                                                    
Mid-Atlantic        |=|September                           |=|          392898                                                    
Southeast US        |=|October                             |=|          536841                                                    
Southeast US        |=|February                            |=|          618423                                                    
Southeast US        |=|March                               |=|          655993                                                    
Southwest US        |=|August                              |=|          447799                                                    
Southwest US        |=|September                           |=|          666520                                                    
Northwest US        |=|August                              |=|          525770                                                    
Central US          |=|August                              |=|          620780                                                    
New England         |=|August                              |=|          547656                                                    
New England         |=|November                            |=|          461395                                                    
New England         |=|December                            |=|          533314                                                    
Mid-Atlantic        |=|October                             |=|          510117                                                    
Southeast US        |=|November                            |=|          553866                                                    
Southeast US        |=|December                            |=|          613700                                                    
Southeast US        |=|June                                |=|          568572                                                    
Southwest US        |=|January                             |=|          637628                                                    
Southwest US        |=|February                            |=|          571706                                                    
Southwest US        |=|April                               |=|          597942                                                    
Northwest US        |=|October                             |=|          598705                                                    
Northwest US        |=|December                            |=|          529781                                                    
Central US          |=|April                               |=|          458383                                                    
Central US          |=|July                                |=|          479537                                                    
Central US          |=|February                            |=|          481184                                                    
New England         |=|July                                |=|          559334                                                    
Southwest US        |=|July                                |=|          420337                                                    
Northwest US        |=|July                                |=|          610418                                                    
Central US          |=|November                            |=|          557309                                                    
New England         |=|May                                 |=|          566285                                                    
Mid-Atlantic        |=|April                               |=|          541146                                                    
Mid-Atlantic        |=|November                            |=|          532889                                                    
Southeast US        |=|August                              |=|          478765                                                    
Northwest US        |=|April                               |=|          631372                                                    
Central US          |=|January                             |=|          450162                                                    
New England         |=|June                                |=|          503354                                                    
New England         |=|September                           |=|          575589                                                    
Southeast US        |=|April                               |=|          610017                                                    
Southwest US        |=|June                                |=|          615202                                                    
New England         |=|January                             |=|          509215                                                    
New England         |=|March                               |=|          566483                                                    
New England         |=|October                             |=|          549648                                                    
Mid-Atlantic        |=|July                                |=|          606914                                                    
Mid-Atlantic        |=|February                            |=|          428676                                                    
Southeast US        |=|January                             |=|          379021                                                    
Southeast US        |=|May                                 |=|          661094                                                    
Southeast US        |=|July                                |=|          556992                                                    
Southwest US        |=|December                            |=|          633101                                                    
Southwest US        |=|October                             |=|          556906                                                    
Northwest US        |=|November                            |=|          467235                                                    
Northwest US        |=|May                                 |=|          752284                                                    
Northwest US        |=|June                                |=|          449683                                                    
Central US          |=|May                                 |=|          565160                                                    
Mid-Atlantic        |=|December                            |=|          492458                                                    
Mid-Atlantic        |=|January                             |=|          610697                                                    
Southeast US        |=|September                           |=|          635211                                                    
Southwest US        |=|May                                 |=|          611506                                                    
Northwest US        |=|February                            |=|          573601                                                    
Northwest US        |=|March                               |=|          577172                                                    
Central US          |=|June                                |=|          566434                                                    
Central US          |=|September                           |=|          536323                                                    
New England         |=|February                            |=|          615746                                                    
New England         |=|April                               |=|          597622                                                    
Mid-Atlantic        |=|June                                |=|          501485                                                    
Mid-Atlantic        |=|March                               |=|          637031                                                    
Southwest US        |=|November                            |=|          595164                                                    
Southwest US        |=|March                               |=|          500920                                                    
Northwest US        |=|January                             |=|          441602                                                    
Northwest US        |=|September                           |=|          581751                                                    
Central US          |=|October                             |=|          527420                                                    
Central US          |=|December                            |=|          522784                                                    
Central US          |=|March                               |=|          473425                                                    
New England         |=|s/Dato                              |=|         6585641                                                    
Mid-Atlantic        |=|s/Dato                              |=|         6307766                                                    
Northwest US        |=|s/Dato                              |=|         6739374                                                    
Southeast US        |=|s/Dato                              |=|         6868495                                                    
Central US          |=|s/Dato                              |=|         6238901                                                    
Southwest US        |=|s/Dato                              |=|         6854731                                                    
s/Dato              |=|January                             |=|         3028325                                                    
s/Dato              |=|June                                |=|         3204730                                                    
s/Dato              |=|November                            |=|         3167858                                                    
s/Dato              |=|February                            |=|         3289336                                                    
s/Dato              |=|May                                 |=|         3749264                                                    
s/Dato              |=|April                               |=|         3436482                                                    
s/Dato              |=|August                              |=|         3081290                                                    
s/Dato              |=|July                                |=|         3233532                                                    
s/Dato              |=|March                               |=|         3411024                                                    
s/Dato              |=|December                            |=|         3325138                                                    
s/Dato              |=|September                           |=|         3388292                                                    
s/Dato              |=|October                             |=|         3279637                                                    
s/Dato              |=|s/Dato                              |=|        39594908                                                    

91 rows selected.

SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,241]
SQL> /*
SQL> The following example illustrates this by taking
SQL> the example of the beginning of this section and reversing the
SQL> order of columns in the CUBE operation
SQL> */
SQL> SELECT R.NAME REGION, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  GROUP BY CUBE(O.MONTH, R.NAME);

REGION              |=|MONTH                               |=|SUM(O.TOT_SALES)                                                    
--------------------|=|------------------------------------|=|----------------                                                    
s/Dato              |=|s/Dato                              |=|        39594908                                                    
Central US          |=|s/Dato                              |=|         6238901                                                    
New England         |=|s/Dato                              |=|         6585641                                                    
Mid-Atlantic        |=|s/Dato                              |=|         6307766                                                    
Northwest US        |=|s/Dato                              |=|         6739374                                                    
Southeast US        |=|s/Dato                              |=|         6868495                                                    
Southwest US        |=|s/Dato                              |=|         6854731                                                    
s/Dato              |=|January                             |=|         3028325                                                    
Central US          |=|January                             |=|          450162                                                    
New England         |=|January                             |=|          509215                                                    
Mid-Atlantic        |=|January                             |=|          610697                                                    
Northwest US        |=|January                             |=|          441602                                                    
Southeast US        |=|January                             |=|          379021                                                    
Southwest US        |=|January                             |=|          637628                                                    
s/Dato              |=|February                            |=|         3289336                                                    
Central US          |=|February                            |=|          481184                                                    
New England         |=|February                            |=|          615746                                                    
Mid-Atlantic        |=|February                            |=|          428676                                                    
Northwest US        |=|February                            |=|          573601                                                    
Southeast US        |=|February                            |=|          618423                                                    
Southwest US        |=|February                            |=|          571706                                                    
s/Dato              |=|March                               |=|         3411024                                                    
Central US          |=|March                               |=|          473425                                                    
New England         |=|March                               |=|          566483                                                    
Mid-Atlantic        |=|March                               |=|          637031                                                    
Northwest US        |=|March                               |=|          577172                                                    
Southeast US        |=|March                               |=|          655993                                                    
Southwest US        |=|March                               |=|          500920                                                    
s/Dato              |=|April                               |=|         3436482                                                    
Central US          |=|April                               |=|          458383                                                    
New England         |=|April                               |=|          597622                                                    
Mid-Atlantic        |=|April                               |=|          541146                                                    
Northwest US        |=|April                               |=|          631372                                                    
Southeast US        |=|April                               |=|          610017                                                    
Southwest US        |=|April                               |=|          597942                                                    
s/Dato              |=|May                                 |=|         3749264                                                    
Central US          |=|May                                 |=|          565160                                                    
New England         |=|May                                 |=|          566285                                                    
Mid-Atlantic        |=|May                                 |=|          592935                                                    
Northwest US        |=|May                                 |=|          752284                                                    
Southeast US        |=|May                                 |=|          661094                                                    
Southwest US        |=|May                                 |=|          611506                                                    
s/Dato              |=|June                                |=|         3204730                                                    
Central US          |=|June                                |=|          566434                                                    
New England         |=|June                                |=|          503354                                                    
Mid-Atlantic        |=|June                                |=|          501485                                                    
Northwest US        |=|June                                |=|          449683                                                    
Southeast US        |=|June                                |=|          568572                                                    
Southwest US        |=|June                                |=|          615202                                                    
s/Dato              |=|July                                |=|         3233532                                                    
Central US          |=|July                                |=|          479537                                                    
New England         |=|July                                |=|          559334                                                    
Mid-Atlantic        |=|July                                |=|          606914                                                    
Northwest US        |=|July                                |=|          610418                                                    
Southeast US        |=|July                                |=|          556992                                                    
Southwest US        |=|July                                |=|          420337                                                    
s/Dato              |=|August                              |=|         3081290                                                    
Central US          |=|August                              |=|          620780                                                    
New England         |=|August                              |=|          547656                                                    
Mid-Atlantic        |=|August                              |=|          460520                                                    
Northwest US        |=|August                              |=|          525770                                                    
Southeast US        |=|August                              |=|          478765                                                    
Southwest US        |=|August                              |=|          447799                                                    
s/Dato              |=|September                           |=|         3388292                                                    
Central US          |=|September                           |=|          536323                                                    
New England         |=|September                           |=|          575589                                                    
Mid-Atlantic        |=|September                           |=|          392898                                                    
Northwest US        |=|September                           |=|          581751                                                    
Southeast US        |=|September                           |=|          635211                                                    
Southwest US        |=|September                           |=|          666520                                                    
s/Dato              |=|October                             |=|         3279637                                                    
Central US          |=|October                             |=|          527420                                                    
New England         |=|October                             |=|          549648                                                    
Mid-Atlantic        |=|October                             |=|          510117                                                    
Northwest US        |=|October                             |=|          598705                                                    
Southeast US        |=|October                             |=|          536841                                                    
Southwest US        |=|October                             |=|          556906                                                    
s/Dato              |=|November                            |=|         3167858                                                    
Central US          |=|November                            |=|          557309                                                    
New England         |=|November                            |=|          461395                                                    
Mid-Atlantic        |=|November                            |=|          532889                                                    
Northwest US        |=|November                            |=|          467235                                                    
Southeast US        |=|November                            |=|          553866                                                    
Southwest US        |=|November                            |=|          595164                                                    
s/Dato              |=|December                            |=|         3325138                                                    
Central US          |=|December                            |=|          522784                                                    
New England         |=|December                            |=|          533314                                                    
Mid-Atlantic        |=|December                            |=|          492458                                                    
Northwest US        |=|December                            |=|          529781                                                    
Southeast US        |=|December                            |=|          613700                                                    
Southwest US        |=|December                            |=|          633101                                                    

91 rows selected.

SQL> 
SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,243]
SQL> rem The GROUPING Function
SQL> SELECT NVL(TO_CHAR(O.YEAR), 'All Years') YEAR,
  2  NVL(TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month'), 'First Quarter') MONTH,
  3  NVL(R.NAME, 'All Regions') REGION, SUM(O.TOT_SALES)
  4  FROM ORDERS O, REGION R
  5  WHERE R.REGION_ID = O.REGION_ID
  6  AND O.MONTH BETWEEN 1 AND 3
  7  GROUP BY ROLLUP (O.YEAR, O.MONTH, R.NAME);

YEAR                                    |=|MONTH                               |=|REGION              |=|SUM(O.TOT_SALES)         
----------------------------------------|=|------------------------------------|=|--------------------|=|----------------         
2001                                    |=|January                             |=|Central US          |=|          450162         
2001                                    |=|January                             |=|New England         |=|          509215         
2001                                    |=|January                             |=|Mid-Atlantic        |=|          610697         
2001                                    |=|January                             |=|Northwest US        |=|          441602         
2001                                    |=|January                             |=|Southeast US        |=|          379021         
2001                                    |=|January                             |=|Southwest US        |=|          637628         
2001                                    |=|January                             |=|All Regions         |=|         3028325         
2001                                    |=|February                            |=|Central US          |=|          481184         
2001                                    |=|February                            |=|New England         |=|          615746         
2001                                    |=|February                            |=|Mid-Atlantic        |=|          428676         
2001                                    |=|February                            |=|Northwest US        |=|          573601         
2001                                    |=|February                            |=|Southeast US        |=|          618423         
2001                                    |=|February                            |=|Southwest US        |=|          571706         
2001                                    |=|February                            |=|All Regions         |=|         3289336         
2001                                    |=|March                               |=|Central US          |=|          473425         
2001                                    |=|March                               |=|New England         |=|          566483         
2001                                    |=|March                               |=|Mid-Atlantic        |=|          637031         
2001                                    |=|March                               |=|Northwest US        |=|          577172         
2001                                    |=|March                               |=|Southeast US        |=|          655993         
2001                                    |=|March                               |=|Southwest US        |=|          500920         
2001                                    |=|March                               |=|All Regions         |=|         3411024         
2001                                    |=|First Quarter                       |=|All Regions         |=|         9728685         
All Years                               |=|First Quarter                       |=|All Regions         |=|         9728685         

23 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,245]
SQL> SELECT NVL(TO_CHAR(CUST_NBR), 'All Customers') CUSTOMER,
  2  NVL(STATUS, 'All Status') STATUS,
  3  COUNT(*) FROM CUST_ORDER
  4  GROUP BY CUBE(CUST_NBR, STATUS);

CUSTOMER                                |=|STATUS|=|  COUNT(*)                                                                    
----------------------------------------|=|------|=|----------                                                                    
All Customers                           |=|All St|=|        20                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
All Customers                           |=|PENDIN|=|         6                                                                    
                                        |=|G     |=|                                                                              
                                                                                                                                  
All Customers                           |=|CANCEL|=|         6                                                                    
                                        |=|LED   |=|                                                                              
                                                                                                                                  
All Customers                           |=|DELIVE|=|         8                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  
1                                       |=|All St|=|         8                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
1                                       |=|CANCEL|=|         4                                                                    
                                        |=|LED   |=|                                                                              
                                                                                                                                  
1                                       |=|DELIVE|=|         4                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  
4                                       |=|All St|=|         4                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
4                                       |=|PENDIN|=|         2                                                                    
                                        |=|G     |=|                                                                              
                                                                                                                                  
4                                       |=|DELIVE|=|         2                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  
5                                       |=|All St|=|         6                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
5                                       |=|PENDIN|=|         4                                                                    
                                        |=|G     |=|                                                                              
                                                                                                                                  
5                                       |=|CANCEL|=|         2                                                                    
                                        |=|LED   |=|                                                                              
                                                                                                                                  
8                                       |=|All St|=|         2                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
8                                       |=|DELIVE|=|         2                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  

15 rows selected.

SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,246]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES),
  3  GROUPING(O.YEAR) Y, GROUPING(O.MONTH) M, GROUPING(R.NAME) R
  4  FROM ORDERS O, REGION R
  5  WHERE R.REGION_ID = O.REGION_ID
  6  AND O.MONTH BETWEEN 1 AND 3
  7  GROUP BY ROLLUP (O.YEAR, O.MONTH, R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|SUM(O.TOT_SALES)|=|         Y|=|         M|=|         R
----------|=|------------------------------------|=|--------------------|=|----------------|=|----------|=|----------|=|----------
      2001|=|January                             |=|Central US          |=|          450162|=|         0|=|         0|=|         0
      2001|=|January                             |=|New England         |=|          509215|=|         0|=|         0|=|         0
      2001|=|January                             |=|Mid-Atlantic        |=|          610697|=|         0|=|         0|=|         0
      2001|=|January                             |=|Northwest US        |=|          441602|=|         0|=|         0|=|         0
      2001|=|January                             |=|Southeast US        |=|          379021|=|         0|=|         0|=|         0
      2001|=|January                             |=|Southwest US        |=|          637628|=|         0|=|         0|=|         0
      2001|=|January                             |=|s/Dato              |=|         3028325|=|         0|=|         0|=|         1
      2001|=|February                            |=|Central US          |=|          481184|=|         0|=|         0|=|         0
      2001|=|February                            |=|New England         |=|          615746|=|         0|=|         0|=|         0
      2001|=|February                            |=|Mid-Atlantic        |=|          428676|=|         0|=|         0|=|         0
      2001|=|February                            |=|Northwest US        |=|          573601|=|         0|=|         0|=|         0
      2001|=|February                            |=|Southeast US        |=|          618423|=|         0|=|         0|=|         0
      2001|=|February                            |=|Southwest US        |=|          571706|=|         0|=|         0|=|         0
      2001|=|February                            |=|s/Dato              |=|         3289336|=|         0|=|         0|=|         1
      2001|=|March                               |=|Central US          |=|          473425|=|         0|=|         0|=|         0
      2001|=|March                               |=|New England         |=|          566483|=|         0|=|         0|=|         0
      2001|=|March                               |=|Mid-Atlantic        |=|          637031|=|         0|=|         0|=|         0
      2001|=|March                               |=|Northwest US        |=|          577172|=|         0|=|         0|=|         0
      2001|=|March                               |=|Southeast US        |=|          655993|=|         0|=|         0|=|         0
      2001|=|March                               |=|Southwest US        |=|          500920|=|         0|=|         0|=|         0
      2001|=|March                               |=|s/Dato              |=|         3411024|=|         0|=|         0|=|         1
      2001|=|s/Dato                              |=|s/Dato              |=|         9728685|=|         0|=|         1|=|         1
s/Dato    |=|s/Dato                              |=|s/Dato              |=|         9728685|=|         1|=|         1|=|         1

23 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,247]
SQL> SELECT DECODE(GROUPING(O.YEAR), 1, 'All Years', O.YEAR) Year,
  2  DECODE(GROUPING(O.MONTH), 1, 'All Months',
  3  TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month')) Month,
  4  DECODE(GROUPING(R.NAME), 1, 'All Regions', R.NAME) Region, SUM(O.TOT_SALES)
  5  FROM ORDERS O, REGION R
  6  WHERE R.REGION_ID = O.REGION_ID
  7  AND O.MONTH BETWEEN 1 AND 3
  8  GROUP BY ROLLUP (O.YEAR, O.MONTH, R.NAME);

YEAR                                    |=|MONTH                               |=|REGION              |=|SUM(O.TOT_SALES)         
----------------------------------------|=|------------------------------------|=|--------------------|=|----------------         
2001                                    |=|January                             |=|Central US          |=|          450162         
2001                                    |=|January                             |=|New England         |=|          509215         
2001                                    |=|January                             |=|Mid-Atlantic        |=|          610697         
2001                                    |=|January                             |=|Northwest US        |=|          441602         
2001                                    |=|January                             |=|Southeast US        |=|          379021         
2001                                    |=|January                             |=|Southwest US        |=|          637628         
2001                                    |=|January                             |=|All Regions         |=|         3028325         
2001                                    |=|February                            |=|Central US          |=|          481184         
2001                                    |=|February                            |=|New England         |=|          615746         
2001                                    |=|February                            |=|Mid-Atlantic        |=|          428676         
2001                                    |=|February                            |=|Northwest US        |=|          573601         
2001                                    |=|February                            |=|Southeast US        |=|          618423         
2001                                    |=|February                            |=|Southwest US        |=|          571706         
2001                                    |=|February                            |=|All Regions         |=|         3289336         
2001                                    |=|March                               |=|Central US          |=|          473425         
2001                                    |=|March                               |=|New England         |=|          566483         
2001                                    |=|March                               |=|Mid-Atlantic        |=|          637031         
2001                                    |=|March                               |=|Northwest US        |=|          577172         
2001                                    |=|March                               |=|Southeast US        |=|          655993         
2001                                    |=|March                               |=|Southwest US        |=|          500920         
2001                                    |=|March                               |=|All Regions         |=|         3411024         
2001                                    |=|All Months                          |=|All Regions         |=|         9728685         
All Years                               |=|All Months                          |=|All Regions         |=|         9728685         

23 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,248]
SQL> 
SQL> SELECT DECODE(GROUPING(CUST_NBR), 1, 'All Customers', CUST_NBR) CUSTOMER,
  2  DECODE(GROUPING(STATUS), 1, 'All Status', STATUS) STATUS, COUNT(*)
  3  FROM CUST_ORDER
  4  GROUP BY CUBE(CUST_NBR, STATUS);

CUSTOMER                                |=|STATUS|=|  COUNT(*)                                                                    
----------------------------------------|=|------|=|----------                                                                    
All Customers                           |=|All St|=|        20                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
All Customers                           |=|PENDIN|=|         6                                                                    
                                        |=|G     |=|                                                                              
                                                                                                                                  
All Customers                           |=|CANCEL|=|         6                                                                    
                                        |=|LED   |=|                                                                              
                                                                                                                                  
All Customers                           |=|DELIVE|=|         8                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  
1                                       |=|All St|=|         8                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
1                                       |=|CANCEL|=|         4                                                                    
                                        |=|LED   |=|                                                                              
                                                                                                                                  
1                                       |=|DELIVE|=|         4                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  
4                                       |=|All St|=|         4                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
4                                       |=|PENDIN|=|         2                                                                    
                                        |=|G     |=|                                                                              
                                                                                                                                  
4                                       |=|DELIVE|=|         2                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  
5                                       |=|All St|=|         6                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
5                                       |=|PENDIN|=|         4                                                                    
                                        |=|G     |=|                                                                              
                                                                                                                                  
5                                       |=|CANCEL|=|         2                                                                    
                                        |=|LED   |=|                                                                              
                                                                                                                                  
8                                       |=|All St|=|         2                                                                    
                                        |=|atus  |=|                                                                              
                                                                                                                                  
8                                       |=|DELIVE|=|         2                                                                    
                                        |=|RED   |=|                                                                              
                                                                                                                                  

15 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,249]
SQL> sELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY GROUPING SETS (O.YEAR, O.MONTH, R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|SUM(O.TOT_SALES)                                       
----------|=|------------------------------------|=|--------------------|=|----------------                                       
s/Dato    |=|s/Dato                              |=|New England         |=|         1691444                                       
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|         1676404                                       
s/Dato    |=|s/Dato                              |=|Northwest US        |=|         1592375                                       
s/Dato    |=|s/Dato                              |=|Southeast US        |=|         1653437                                       
s/Dato    |=|s/Dato                              |=|Central US          |=|         1404771                                       
s/Dato    |=|s/Dato                              |=|Southwest US        |=|         1710254                                       
s/Dato    |=|January                             |=|s/Dato              |=|         3028325                                       
s/Dato    |=|February                            |=|s/Dato              |=|         3289336                                       
s/Dato    |=|March                               |=|s/Dato              |=|         3411024                                       
      2001|=|s/Dato                              |=|s/Dato              |=|         9728685                                       

10 rows selected.

SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,250]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES)
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY GROUPING SETS (O.MONTH, R.NAME, O.YEAR);

      YEAR|=|MONTH                               |=|REGION              |=|SUM(O.TOT_SALES)                                       
----------|=|------------------------------------|=|--------------------|=|----------------                                       
s/Dato    |=|s/Dato                              |=|New England         |=|         1691444                                       
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|         1676404                                       
s/Dato    |=|s/Dato                              |=|Northwest US        |=|         1592375                                       
s/Dato    |=|s/Dato                              |=|Southeast US        |=|         1653437                                       
s/Dato    |=|s/Dato                              |=|Central US          |=|         1404771                                       
s/Dato    |=|s/Dato                              |=|Southwest US        |=|         1710254                                       
s/Dato    |=|January                             |=|s/Dato              |=|         3028325                                       
s/Dato    |=|February                            |=|s/Dato              |=|         3289336                                       
s/Dato    |=|March                               |=|s/Dato              |=|         3411024                                       
      2001|=|s/Dato                              |=|s/Dato              |=|         9728685                                       

10 rows selected.

SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,251]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) TOTAL
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY O.YEAR, ROLLUP (O.YEAR, O.MONTH, R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
      2001|=|January                             |=|Central US          |=|    450162                                             
      2001|=|January                             |=|New England         |=|    509215                                             
      2001|=|January                             |=|Mid-Atlantic        |=|    610697                                             
      2001|=|January                             |=|Northwest US        |=|    441602                                             
      2001|=|January                             |=|Southeast US        |=|    379021                                             
      2001|=|January                             |=|Southwest US        |=|    637628                                             
      2001|=|January                             |=|s/Dato              |=|   3028325                                             
      2001|=|February                            |=|Central US          |=|    481184                                             
      2001|=|February                            |=|New England         |=|    615746                                             
      2001|=|February                            |=|Mid-Atlantic        |=|    428676                                             
      2001|=|February                            |=|Northwest US        |=|    573601                                             
      2001|=|February                            |=|Southeast US        |=|    618423                                             
      2001|=|February                            |=|Southwest US        |=|    571706                                             
      2001|=|February                            |=|s/Dato              |=|   3289336                                             
      2001|=|March                               |=|Central US          |=|    473425                                             
      2001|=|March                               |=|New England         |=|    566483                                             
      2001|=|March                               |=|Mid-Atlantic        |=|    637031                                             
      2001|=|March                               |=|Northwest US        |=|    577172                                             
      2001|=|March                               |=|Southeast US        |=|    655993                                             
      2001|=|March                               |=|Southwest US        |=|    500920                                             
      2001|=|March                               |=|s/Dato              |=|   3411024                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             

23 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,253]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) Total
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY ROLLUP ((O.YEAR, O.MONTH),R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
      2001|=|January                             |=|Central US          |=|    450162                                             
      2001|=|January                             |=|New England         |=|    509215                                             
      2001|=|January                             |=|Mid-Atlantic        |=|    610697                                             
      2001|=|January                             |=|Northwest US        |=|    441602                                             
      2001|=|January                             |=|Southeast US        |=|    379021                                             
      2001|=|January                             |=|Southwest US        |=|    637628                                             
      2001|=|January                             |=|s/Dato              |=|   3028325                                             
      2001|=|February                            |=|Central US          |=|    481184                                             
      2001|=|February                            |=|New England         |=|    615746                                             
      2001|=|February                            |=|Mid-Atlantic        |=|    428676                                             
      2001|=|February                            |=|Northwest US        |=|    573601                                             
      2001|=|February                            |=|Southeast US        |=|    618423                                             
      2001|=|February                            |=|Southwest US        |=|    571706                                             
      2001|=|February                            |=|s/Dato              |=|   3289336                                             
      2001|=|March                               |=|Central US          |=|    473425                                             
      2001|=|March                               |=|New England         |=|    566483                                             
      2001|=|March                               |=|Mid-Atlantic        |=|    637031                                             
      2001|=|March                               |=|Northwest US        |=|    577172                                             
      2001|=|March                               |=|Southeast US        |=|    655993                                             
      2001|=|March                               |=|Southwest US        |=|    500920                                             
      2001|=|March                               |=|s/Dato              |=|   3411024                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             

22 rows selected.

SQL> 
SQL> 
SQL> 
SQL> rem [Mishra & Beaulieu,2002,254]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) Total
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY ROLLUP (O.YEAR, O.MONTH), ROLLUP(R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
      2001|=|s/Dato                              |=|Central US          |=|   1404771                                             
      2001|=|s/Dato                              |=|New England         |=|   1691444                                             
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375                                             
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
      2001|=|January                             |=|Central US          |=|    450162                                             
      2001|=|January                             |=|New England         |=|    509215                                             
      2001|=|January                             |=|Mid-Atlantic        |=|    610697                                             
      2001|=|January                             |=|Northwest US        |=|    441602                                             
      2001|=|January                             |=|Southeast US        |=|    379021                                             
      2001|=|January                             |=|Southwest US        |=|    637628                                             
      2001|=|January                             |=|s/Dato              |=|   3028325                                             
      2001|=|February                            |=|Central US          |=|    481184                                             
      2001|=|February                            |=|New England         |=|    615746                                             
      2001|=|February                            |=|Mid-Atlantic        |=|    428676                                             
      2001|=|February                            |=|Northwest US        |=|    573601                                             
      2001|=|February                            |=|Southeast US        |=|    618423                                             
      2001|=|February                            |=|Southwest US        |=|    571706                                             
      2001|=|February                            |=|s/Dato              |=|   3289336                                             
      2001|=|March                               |=|Central US          |=|    473425                                             
      2001|=|March                               |=|New England         |=|    566483                                             
      2001|=|March                               |=|Mid-Atlantic        |=|    637031                                             
      2001|=|March                               |=|Northwest US        |=|    577172                                             
      2001|=|March                               |=|Southeast US        |=|    655993                                             
      2001|=|March                               |=|Southwest US        |=|    500920                                             
      2001|=|March                               |=|s/Dato              |=|   3411024                                             

35 rows selected.

SQL> /

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
      2001|=|s/Dato                              |=|Central US          |=|   1404771                                             
      2001|=|s/Dato                              |=|New England         |=|   1691444                                             
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375                                             
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
      2001|=|January                             |=|Central US          |=|    450162                                             
      2001|=|January                             |=|New England         |=|    509215                                             
      2001|=|January                             |=|Mid-Atlantic        |=|    610697                                             
      2001|=|January                             |=|Northwest US        |=|    441602                                             
      2001|=|January                             |=|Southeast US        |=|    379021                                             
      2001|=|January                             |=|Southwest US        |=|    637628                                             
      2001|=|January                             |=|s/Dato              |=|   3028325                                             
      2001|=|February                            |=|Central US          |=|    481184                                             
      2001|=|February                            |=|New England         |=|    615746                                             
      2001|=|February                            |=|Mid-Atlantic        |=|    428676                                             
      2001|=|February                            |=|Northwest US        |=|    573601                                             
      2001|=|February                            |=|Southeast US        |=|    618423                                             
      2001|=|February                            |=|Southwest US        |=|    571706                                             
      2001|=|February                            |=|s/Dato              |=|   3289336                                             
      2001|=|March                               |=|Central US          |=|    473425                                             
      2001|=|March                               |=|New England         |=|    566483                                             
      2001|=|March                               |=|Mid-Atlantic        |=|    637031                                             
      2001|=|March                               |=|Northwest US        |=|    577172                                             
      2001|=|March                               |=|Southeast US        |=|    655993                                             
      2001|=|March                               |=|Southwest US        |=|    500920                                             
      2001|=|March                               |=|s/Dato              |=|   3411024                                             

35 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,256]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) Total
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY GROUPING SETS (O.YEAR, O.MONTH), GROUPING SETS (R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|January                             |=|New England         |=|    509215                                             
s/Dato    |=|March                               |=|Mid-Atlantic        |=|    637031                                             
s/Dato    |=|February                            |=|Southeast US        |=|    618423                                             
s/Dato    |=|February                            |=|Northwest US        |=|    573601                                             
s/Dato    |=|February                            |=|Southwest US        |=|    571706                                             
s/Dato    |=|March                               |=|Southwest US        |=|    500920                                             
s/Dato    |=|January                             |=|Central US          |=|    450162                                             
s/Dato    |=|February                            |=|Central US          |=|    481184                                             
s/Dato    |=|March                               |=|Central US          |=|    473425                                             
s/Dato    |=|February                            |=|Mid-Atlantic        |=|    428676                                             
s/Dato    |=|January                             |=|Southeast US        |=|    379021                                             
s/Dato    |=|January                             |=|Northwest US        |=|    441602                                             
s/Dato    |=|March                               |=|Northwest US        |=|    577172                                             
s/Dato    |=|March                               |=|New England         |=|    566483                                             
s/Dato    |=|January                             |=|Mid-Atlantic        |=|    610697                                             
s/Dato    |=|March                               |=|Southeast US        |=|    655993                                             
s/Dato    |=|January                             |=|Southwest US        |=|    637628                                             
s/Dato    |=|February                            |=|New England         |=|    615746                                             
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254                                             
      2001|=|s/Dato                              |=|New England         |=|   1691444                                             
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375                                             
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
      2001|=|s/Dato                              |=|Central US          |=|   1404771                                             

24 rows selected.

SQL> /

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|January                             |=|New England         |=|    509215                                             
s/Dato    |=|March                               |=|Mid-Atlantic        |=|    637031                                             
s/Dato    |=|February                            |=|Southeast US        |=|    618423                                             
s/Dato    |=|February                            |=|Northwest US        |=|    573601                                             
s/Dato    |=|February                            |=|Southwest US        |=|    571706                                             
s/Dato    |=|March                               |=|Southwest US        |=|    500920                                             
s/Dato    |=|January                             |=|Central US          |=|    450162                                             
s/Dato    |=|February                            |=|Central US          |=|    481184                                             
s/Dato    |=|March                               |=|Central US          |=|    473425                                             
s/Dato    |=|February                            |=|Mid-Atlantic        |=|    428676                                             
s/Dato    |=|January                             |=|Southeast US        |=|    379021                                             
s/Dato    |=|January                             |=|Northwest US        |=|    441602                                             
s/Dato    |=|March                               |=|Northwest US        |=|    577172                                             
s/Dato    |=|March                               |=|New England         |=|    566483                                             
s/Dato    |=|January                             |=|Mid-Atlantic        |=|    610697                                             
s/Dato    |=|March                               |=|Southeast US        |=|    655993                                             
s/Dato    |=|January                             |=|Southwest US        |=|    637628                                             
s/Dato    |=|February                            |=|New England         |=|    615746                                             
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254                                             
      2001|=|s/Dato                              |=|New England         |=|   1691444                                             
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375                                             
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
      2001|=|s/Dato                              |=|Central US          |=|   1404771                                             

24 rows selected.

SQL> rem [Mishra & Beaulieu,2002,258]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2   R.NAME REGION, SUM(O.TOT_SALES) Total
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY GROUPING SETS (ROLLUP (O.YEAR), ROLLUP (O.MONTH), ROLLUP(R.NAME));

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|January                             |=|s/Dato              |=|   3028325                                             
s/Dato    |=|February                            |=|s/Dato              |=|   3289336                                             
s/Dato    |=|March                               |=|s/Dato              |=|   3411024                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             

13 rows selected.

SQL> /

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|January                             |=|s/Dato              |=|   3028325                                             
s/Dato    |=|February                            |=|s/Dato              |=|   3289336                                             
s/Dato    |=|March                               |=|s/Dato              |=|   3411024                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             

13 rows selected.

SQL> rem [Mishra & Beaulieu,2002,259]
SQL> 
SQL> SELECT DISTINCT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) Total
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY GROUPING SETS (ROLLUP (O.YEAR), ROLLUP (O.MONTH), ROLLUP(R.NAME));

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|January                             |=|s/Dato              |=|   3028325                                             
s/Dato    |=|February                            |=|s/Dato              |=|   3289336                                             
s/Dato    |=|March                               |=|s/Dato              |=|   3411024                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             

11 rows selected.

SQL> /

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|January                             |=|s/Dato              |=|   3028325                                             
s/Dato    |=|February                            |=|s/Dato              |=|   3289336                                             
s/Dato    |=|March                               |=|s/Dato              |=|   3411024                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             

11 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,261]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) Total,
  3  GROUPING(O.YEAR) Y, GROUPING(O.MONTH) M, GROUPING(R.NAME) R,
  4  GROUPING_ID (O.YEAR, O.MONTH, R.NAME) GID
  5  FROM ORDERS O, REGION R
  6  WHERE R.REGION_ID = O.REGION_ID
  7  AND O.MONTH BETWEEN 1 AND 3
  8  GROUP BY CUBE (O.YEAR, O.MONTH, R.NAME);

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL|=|         Y|=|         M|=|         R      
----------|=|------------------------------------|=|--------------------|=|----------|=|----------|=|----------|=|----------      
       GID                                                                                                                        
----------                                                                                                                        
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685|=|         1|=|         1|=|         1      
         7                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|s/Dato              |=|   3028325|=|         1|=|         0|=|         1      
         5                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Central US          |=|    450162|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|New England         |=|    509215|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Mid-Atlantic        |=|    610697|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Northwest US        |=|    441602|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Southeast US        |=|    379021|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Southwest US        |=|    637628|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|s/Dato              |=|   3289336|=|         1|=|         0|=|         1      
         5                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Central US          |=|    481184|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|New England         |=|    615746|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Mid-Atlantic        |=|    428676|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Northwest US        |=|    573601|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Southeast US        |=|    618423|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Southwest US        |=|    571706|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|s/Dato              |=|   3411024|=|         1|=|         0|=|         1      
         5                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Central US          |=|    473425|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|New England         |=|    566483|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Mid-Atlantic        |=|    637031|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Northwest US        |=|    577172|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Southeast US        |=|    655993|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Southwest US        |=|    500920|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685|=|         0|=|         1|=|         1      
         3                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Central US          |=|   1404771|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|New England         |=|   1691444|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404|=|         0|=|         1|=|         0      

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL|=|         Y|=|         M|=|         R      
----------|=|------------------------------------|=|--------------------|=|----------|=|----------|=|----------|=|----------      
       GID                                                                                                                        
----------                                                                                                                        
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|s/Dato              |=|   3028325|=|         0|=|         0|=|         1      
         1                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Central US          |=|    450162|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|New England         |=|    509215|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Mid-Atlantic        |=|    610697|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Northwest US        |=|    441602|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Southeast US        |=|    379021|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Southwest US        |=|    637628|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|s/Dato              |=|   3289336|=|         0|=|         0|=|         1      
         1                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Central US          |=|    481184|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|New England         |=|    615746|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Mid-Atlantic        |=|    428676|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Northwest US        |=|    573601|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Southeast US        |=|    618423|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Southwest US        |=|    571706|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|s/Dato              |=|   3411024|=|         0|=|         0|=|         1      
         1                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Central US          |=|    473425|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|New England         |=|    566483|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Mid-Atlantic        |=|    637031|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Northwest US        |=|    577172|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Southeast US        |=|    655993|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Southwest US        |=|    500920|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  

56 rows selected.

SQL> /

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL|=|         Y|=|         M|=|         R      
----------|=|------------------------------------|=|--------------------|=|----------|=|----------|=|----------|=|----------      
       GID                                                                                                                        
----------                                                                                                                        
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685|=|         1|=|         1|=|         1      
         7                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254|=|         1|=|         1|=|         0      
         6                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|s/Dato              |=|   3028325|=|         1|=|         0|=|         1      
         5                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Central US          |=|    450162|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|New England         |=|    509215|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Mid-Atlantic        |=|    610697|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Northwest US        |=|    441602|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Southeast US        |=|    379021|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|January                             |=|Southwest US        |=|    637628|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|s/Dato              |=|   3289336|=|         1|=|         0|=|         1      
         5                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Central US          |=|    481184|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|New England         |=|    615746|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Mid-Atlantic        |=|    428676|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Northwest US        |=|    573601|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Southeast US        |=|    618423|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|February                            |=|Southwest US        |=|    571706|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|s/Dato              |=|   3411024|=|         1|=|         0|=|         1      
         5                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Central US          |=|    473425|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|New England         |=|    566483|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Mid-Atlantic        |=|    637031|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Northwest US        |=|    577172|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Southeast US        |=|    655993|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
s/Dato    |=|March                               |=|Southwest US        |=|    500920|=|         1|=|         0|=|         0      
         4                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685|=|         0|=|         1|=|         1      
         3                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Central US          |=|   1404771|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|New England         |=|   1691444|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404|=|         0|=|         1|=|         0      

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL|=|         Y|=|         M|=|         R      
----------|=|------------------------------------|=|--------------------|=|----------|=|----------|=|----------|=|----------      
       GID                                                                                                                        
----------                                                                                                                        
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254|=|         0|=|         1|=|         0      
         2                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|s/Dato              |=|   3028325|=|         0|=|         0|=|         1      
         1                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Central US          |=|    450162|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|New England         |=|    509215|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Mid-Atlantic        |=|    610697|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Northwest US        |=|    441602|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Southeast US        |=|    379021|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|January                             |=|Southwest US        |=|    637628|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|s/Dato              |=|   3289336|=|         0|=|         0|=|         1      
         1                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Central US          |=|    481184|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|New England         |=|    615746|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Mid-Atlantic        |=|    428676|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Northwest US        |=|    573601|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Southeast US        |=|    618423|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|February                            |=|Southwest US        |=|    571706|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|s/Dato              |=|   3411024|=|         0|=|         0|=|         1      
         1                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Central US          |=|    473425|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|New England         |=|    566483|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Mid-Atlantic        |=|    637031|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Northwest US        |=|    577172|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Southeast US        |=|    655993|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  
      2001|=|March                               |=|Southwest US        |=|    500920|=|         0|=|         0|=|         0      
         0                                                                                                                        
                                                                                                                                  

56 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,263]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) Total
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY CUBE (O.YEAR, O.MONTH, R.NAME)
  7  HAVING GROUPING(O.YEAR) > 0
  8  OR GROUPING(O.MONTH) > 0
  9  OR GROUPING(R.NAME) > 0;

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|January                             |=|s/Dato              |=|   3028325                                             
s/Dato    |=|January                             |=|Central US          |=|    450162                                             
s/Dato    |=|January                             |=|New England         |=|    509215                                             
s/Dato    |=|January                             |=|Mid-Atlantic        |=|    610697                                             
s/Dato    |=|January                             |=|Northwest US        |=|    441602                                             
s/Dato    |=|January                             |=|Southeast US        |=|    379021                                             
s/Dato    |=|January                             |=|Southwest US        |=|    637628                                             
s/Dato    |=|February                            |=|s/Dato              |=|   3289336                                             
s/Dato    |=|February                            |=|Central US          |=|    481184                                             
s/Dato    |=|February                            |=|New England         |=|    615746                                             
s/Dato    |=|February                            |=|Mid-Atlantic        |=|    428676                                             
s/Dato    |=|February                            |=|Northwest US        |=|    573601                                             
s/Dato    |=|February                            |=|Southeast US        |=|    618423                                             
s/Dato    |=|February                            |=|Southwest US        |=|    571706                                             
s/Dato    |=|March                               |=|s/Dato              |=|   3411024                                             
s/Dato    |=|March                               |=|Central US          |=|    473425                                             
s/Dato    |=|March                               |=|New England         |=|    566483                                             
s/Dato    |=|March                               |=|Mid-Atlantic        |=|    637031                                             
s/Dato    |=|March                               |=|Northwest US        |=|    577172                                             
s/Dato    |=|March                               |=|Southeast US        |=|    655993                                             
s/Dato    |=|March                               |=|Southwest US        |=|    500920                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
      2001|=|s/Dato                              |=|Central US          |=|   1404771                                             
      2001|=|s/Dato                              |=|New England         |=|   1691444                                             
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375                                             
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254                                             
      2001|=|January                             |=|s/Dato              |=|   3028325                                             
      2001|=|February                            |=|s/Dato              |=|   3289336                                             
      2001|=|March                               |=|s/Dato              |=|   3411024                                             

38 rows selected.

SQL> /

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL                                             
----------|=|------------------------------------|=|--------------------|=|----------                                             
s/Dato    |=|s/Dato                              |=|s/Dato              |=|   9728685                                             
s/Dato    |=|s/Dato                              |=|Central US          |=|   1404771                                             
s/Dato    |=|s/Dato                              |=|New England         |=|   1691444                                             
s/Dato    |=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
s/Dato    |=|s/Dato                              |=|Northwest US        |=|   1592375                                             
s/Dato    |=|s/Dato                              |=|Southeast US        |=|   1653437                                             
s/Dato    |=|s/Dato                              |=|Southwest US        |=|   1710254                                             
s/Dato    |=|January                             |=|s/Dato              |=|   3028325                                             
s/Dato    |=|January                             |=|Central US          |=|    450162                                             
s/Dato    |=|January                             |=|New England         |=|    509215                                             
s/Dato    |=|January                             |=|Mid-Atlantic        |=|    610697                                             
s/Dato    |=|January                             |=|Northwest US        |=|    441602                                             
s/Dato    |=|January                             |=|Southeast US        |=|    379021                                             
s/Dato    |=|January                             |=|Southwest US        |=|    637628                                             
s/Dato    |=|February                            |=|s/Dato              |=|   3289336                                             
s/Dato    |=|February                            |=|Central US          |=|    481184                                             
s/Dato    |=|February                            |=|New England         |=|    615746                                             
s/Dato    |=|February                            |=|Mid-Atlantic        |=|    428676                                             
s/Dato    |=|February                            |=|Northwest US        |=|    573601                                             
s/Dato    |=|February                            |=|Southeast US        |=|    618423                                             
s/Dato    |=|February                            |=|Southwest US        |=|    571706                                             
s/Dato    |=|March                               |=|s/Dato              |=|   3411024                                             
s/Dato    |=|March                               |=|Central US          |=|    473425                                             
s/Dato    |=|March                               |=|New England         |=|    566483                                             
s/Dato    |=|March                               |=|Mid-Atlantic        |=|    637031                                             
s/Dato    |=|March                               |=|Northwest US        |=|    577172                                             
s/Dato    |=|March                               |=|Southeast US        |=|    655993                                             
s/Dato    |=|March                               |=|Southwest US        |=|    500920                                             
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685                                             
      2001|=|s/Dato                              |=|Central US          |=|   1404771                                             
      2001|=|s/Dato                              |=|New England         |=|   1691444                                             
      2001|=|s/Dato                              |=|Mid-Atlantic        |=|   1676404                                             
      2001|=|s/Dato                              |=|Northwest US        |=|   1592375                                             
      2001|=|s/Dato                              |=|Southeast US        |=|   1653437                                             
      2001|=|s/Dato                              |=|Southwest US        |=|   1710254                                             
      2001|=|January                             |=|s/Dato              |=|   3028325                                             
      2001|=|February                            |=|s/Dato              |=|   3289336                                             
      2001|=|March                               |=|s/Dato              |=|   3411024                                             

38 rows selected.

SQL> 
SQL> rem [Mishra & Beaulieu,2002,265]
SQL> SELECT O.YEAR, TO_CHAR(TO_DATE(O.MONTH, 'MM'), 'Month') MONTH,
  2  R.NAME REGION, SUM(O.TOT_SALES) Total, GROUP_ID( )
  3  FROM ORDERS O, REGION R
  4  WHERE R.REGION_ID = O.REGION_ID
  5  AND O.MONTH BETWEEN 1 AND 3
  6  GROUP BY O.YEAR, ROLLUP (O.YEAR, O.MONTH, R.NAME)
  7  HAVING GROUP_ID( ) = 0;

      YEAR|=|MONTH                               |=|REGION              |=|     TOTAL|=|GROUP_ID()                                
----------|=|------------------------------------|=|--------------------|=|----------|=|----------                                
      2001|=|January                             |=|Central US          |=|    450162|=|         0                                
      2001|=|January                             |=|New England         |=|    509215|=|         0                                
      2001|=|January                             |=|Mid-Atlantic        |=|    610697|=|         0                                
      2001|=|January                             |=|Northwest US        |=|    441602|=|         0                                
      2001|=|January                             |=|Southeast US        |=|    379021|=|         0                                
      2001|=|January                             |=|Southwest US        |=|    637628|=|         0                                
      2001|=|January                             |=|s/Dato              |=|   3028325|=|         0                                
      2001|=|February                            |=|Central US          |=|    481184|=|         0                                
      2001|=|February                            |=|New England         |=|    615746|=|         0                                
      2001|=|February                            |=|Mid-Atlantic        |=|    428676|=|         0                                
      2001|=|February                            |=|Northwest US        |=|    573601|=|         0                                
      2001|=|February                            |=|Southeast US        |=|    618423|=|         0                                
      2001|=|February                            |=|Southwest US        |=|    571706|=|         0                                
      2001|=|February                            |=|s/Dato              |=|   3289336|=|         0                                
      2001|=|March                               |=|Central US          |=|    473425|=|         0                                
      2001|=|March                               |=|New England         |=|    566483|=|         0                                
      2001|=|March                               |=|Mid-Atlantic        |=|    637031|=|         0                                
      2001|=|March                               |=|Northwest US        |=|    577172|=|         0                                
      2001|=|March                               |=|Southeast US        |=|    655993|=|         0                                
      2001|=|March                               |=|Southwest US        |=|    500920|=|         0                                
      2001|=|March                               |=|s/Dato              |=|   3411024|=|         0                                
      2001|=|s/Dato                              |=|s/Dato              |=|   9728685|=|         0                                

22 rows selected.

SQL> 
SQL> 
SQL> spool off
